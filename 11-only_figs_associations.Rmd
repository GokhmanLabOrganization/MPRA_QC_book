# Associations QC



```{r, echo=FALSE}
library(png)
library(grid)
```

```{r, echo=FALSE}
working_dir="/home/labs/davidgo/Collaboration/L4_MPRA/"
output_dir=sprintf("%s/test_QC",working_dir)
```


## Barcodes per cCRE
**Goal:** <br>
**Input file:**<br>
**Evaluated metrics**:<br>


```{r,echo=FALSE}


bad_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/associations/output/Max_MPRA_run2/Barcodes per cCRE.png",native = T)
good_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/associations/output/PMID_38766054_Reilly/Barcodes per cCRE.png",native = T)

# Start new page and define layout
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))

# Helper to specify location in layout
vplayout <- function(row, col) viewport(layout.pos.row = row, layout.pos.col = col)

# Draw both images in the layout without using print()
pushViewport(vplayout(1, 2))
grid.raster(bad_example, interpolate = FALSE)
popViewport()

pushViewport(vplayout(1, 1))
grid.raster(good_example, interpolate = FALSE)
popViewport()
```

**Legend:** <br>
**Interpretation:**<br>


## PCR bias - GC content
### Reads per GC bin 
**Goal:** <br>
**Input file:**<br>
**Evaluated metrics**:<br>
```{r,echo=FALSE}


bad_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/associations/output/Max_MPRA_run2/PCR bias - GC content.png",native = T)
good_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/associations/output/PMID_38766054_Reilly/PCR bias - GC content.png",native = T)


# Start new page and define layout
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))

# Helper to specify location in layout
vplayout <- function(row, col) viewport(layout.pos.row = row, layout.pos.col = col)

# Draw both images in the layout without using print()
pushViewport(vplayout(1, 2))
grid.raster(bad_example, interpolate = FALSE)
popViewport()

pushViewport(vplayout(1, 1))
grid.raster(good_example, interpolate = FALSE)
popViewport()
```

**Legend:** <br>
**Interpretation:**<br>





## PCR bias - G Stretch
### Reads per G stretch bin
**Goal:** <br>
**Input file:**<br>
**Evaluated metrics**:<br>

```{r,echo=FALSE}
bad_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/placeholder.png",native = T)
good_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/associations/output/thylacine_biorxiv_Gallego_Romero/PCR bias - G-stretches.png",native = T)


# Start new page and define layout
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))

# Helper to specify location in layout
vplayout <- function(row, col) viewport(layout.pos.row = row, layout.pos.col = col)

# Draw both images in the layout without using print()
pushViewport(vplayout(1, 2))
grid.raster(bad_example, interpolate = FALSE)
popViewport()

pushViewport(vplayout(1, 1))
grid.raster(good_example, interpolate = FALSE)
popViewport()
```

**Legend:** <br>
**Interpretation:**<br>



## cCRE-barcode observations
**Goal:** <br>
**Input file:**<br>
**Evaluated metrics**:<br>
```{r,echo=FALSE}


bad_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/associations/output/Max_MPRA_run2/cCRE-barcode observations.png",native = T)
good_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/associations/output/PMID_38766054_Reilly/cCRE-barcode observations.png",native = T)


# Start new page and define layout
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))

# Helper to specify location in layout
vplayout <- function(row, col) viewport(layout.pos.row = row, layout.pos.col = col)

# Draw both images in the layout without using print()
pushViewport(vplayout(1, 2))
grid.raster(bad_example, interpolate = FALSE)
popViewport()

pushViewport(vplayout(1, 1))
grid.raster(good_example, interpolate = FALSE)
popViewport()
```

**Legend:** <br>
**Interpretation:**<br>


## Retained cCREs
**Goal:** <br>
**Input file:**<br>
**Evaluated metrics**:<br>
```{r,echo=FALSE}


bad_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/associations/output/Max_MPRA_run2/Retained cCREs.png",native = T)
good_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/associations/output/PMID_38766054_Reilly/Retained cCREs.png",native = T)

# Start new page and define layout
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))

# Helper to specify location in layout
vplayout <- function(row, col) viewport(layout.pos.row = row, layout.pos.col = col)

# Draw both images in the layout without using print()
pushViewport(vplayout(1, 2))
grid.raster(bad_example, interpolate = FALSE)
popViewport()

pushViewport(vplayout(1, 1))
grid.raster(good_example, interpolate = FALSE)
popViewport()
```

**Legend:** <br>
**Interpretation:**<br>


## Barcode promiscuity
**Goal:** <br>
**Input file:**<br>
**Evaluated metrics**:<br>
```{r,echo=FALSE}


bad_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/associations/output/Max_MPRA_run2/Barcode promiscuity_shuffled.png",native = T)
good_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/associations/output/PMID_38766054_Reilly/Barcode promiscuity.png"
,native = T)

# Start new page and define layout
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))

# Helper to specify location in layout
vplayout <- function(row, col) viewport(layout.pos.row = row, layout.pos.col = col)

# Draw both images in the layout without using print()
pushViewport(vplayout(1, 2))
grid.raster(bad_example, interpolate = FALSE)
popViewport()

pushViewport(vplayout(1, 1))
grid.raster(good_example, interpolate = FALSE)
popViewport()
```

**Legend:** <br>
**Interpretation:**<br>


## Downsampling - Retained cCREs
**Goal:** <br>
**Input file:**<br>
**Evaluated metrics**:<br>
```{r,echo=FALSE}



bad_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/associations/output/L3a2_281122/Downsampling - Retained cCREs.png",native = T)
good_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/associations/output/Max_MPRA_run2/Downsampling - Retained cCREs.png",native = T)

# Start new page and define layout
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))

# Helper to specify location in layout
vplayout <- function(row, col) viewport(layout.pos.row = row, layout.pos.col = col)

# Draw both images in the layout without using print()
pushViewport(vplayout(1, 2))
grid.raster(bad_example, interpolate = FALSE)
popViewport()

pushViewport(vplayout(1, 1))
grid.raster(good_example, interpolate = FALSE)
popViewport()
```

**Legend:** <br>
**Interpretation:**<br>


## Downsampling - Barcodes per cCRE
**Goal:** <br>
**Input file:**<br>
**Evaluated metrics**:<br>
```{r,echo=FALSE}

bad_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/associations/output/Max_MPRA_run2/Downsampling - Barcodes per cCRE.png",native = T)
good_example <- readPNG("/home/labs/davidgo/Collaboration/MPRA_QC_pipeline/associations/output/L3a2_281122/Downsampling - Barcodes per cCRE.png" ,native = T)

# Start new page and define layout
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))

# Helper to specify location in layout
vplayout <- function(row, col) viewport(layout.pos.row = row, layout.pos.col = col)

# Draw both images in the layout without using print()
pushViewport(vplayout(1, 2))
grid.raster(bad_example, interpolate = FALSE)
popViewport()

pushViewport(vplayout(1, 1))
grid.raster(good_example, interpolate = FALSE)
popViewport()
```

**Legend:** <br>
**Interpretation:**<br>