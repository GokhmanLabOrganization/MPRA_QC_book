[["index.html", "Quality Control Pipeline for Massively Parallel Reporter Assays (MPRAs) Overview Usage Scripts", " Quality Control Pipeline for Massively Parallel Reporter Assays (MPRAs) Omer Ronen 2026-01-13 Overview This pipeline is designed to help investigators evaluate the quality of their MPRA, quickly identify pitfalls, trace them to their source, and mitigate them. The scripts provided help ensure that the resulting MPRA data are suitable for robust statistical analysis and meaningful biological interpretation. This Bookdown accompanies our guide for best practices for MPRAs, which outlines recommendations for study design and interpretation [REF]. The manuscript covers all key experimental and analytical steps, including library design, and estimation of activity differential activity. It then describes core problems that often compromise MPRA quality, illustrating how these issues manifest in the data, and offering practical strategies for correction and optimization. Because each issue can influence multiple quality metrics, and each metric may be affected by several issues, the relationships form a many-to-many network. The figures presented below map these interdependencies and connect them to recommended diagnostic analyses. Usage A scheme of root problems, the impacted quality metrics and analyses for the cCRE-barcode association step. Root problems, impacted quality metrics and recommended analyses for the RNA and DNA quantification step. The quality control (QC) pipeline is organized into three chapters: QC of the barcode association step QC of activity estimation QC of differential activity estimation For each analysis, we provide an example of a successful and an unsuccessful dataset to illustrate how they manifest in the analysis. We welcome questions, feedback, or suggestions. Please feel free to reach out at david.gokhman [at] weizmann.ac.il. Scripts All of these analyses are integrated into the quality control pipeline described in this resource, with scripts provided here: [link]. "],["a-guide-for-running-the-analyses-notebook.html", "Chapter 1 A guide for running the analyses notebook 1.1 Associations 1.2 Activity", " Chapter 1 A guide for running the analyses notebook The QC pipeline is organized into two main chapters: Associations and Activity. Each chapter is accompanied by a dedicated script that allows the user to run all analyses presented in this book. Below, we describe the files required to run the pipeline. Note that not all files are required for every analysis, as each analysis has its own specific input requirements 1.1 Associations 1.1.1 Script Association_analysis.ipynb 1.1.2 Input The raw output files are generated during the processing of the MPRA raw data. These files serve as the inputs for Process_for_association_QC.py, which generates the following input files for this chapter: final_df: Barcode - cCRE association file, must include three columns: barcode, cCRE and match_count which represents the number of unique barcode - cCRE observations. This is the key file for association chapter association_before_minimum_associations: Barcode - cCRE association file before filtering for a minimal number of unique observations for each pair, must include three columns: barcode, cCRE and match_count which represents the number of unique barcode - cCRE observations association_before_promiscuity: Barcode - cCRE association file before filtering out barcodes that are associated with multiple cCREs, must include three columns: barcode, cCRE and match_count which represents the number of unique barcode - cCRE observations 1.1.3 Output Output figures are presented in this book in chapter 2 1.2 Activity 1.2.1 Script activity_analysis.ipynb 1.2.2 Input Most of the input files are generated during the processing of the MPRA raw data and the rest are created by combining the processed results with additional data sources comb_df: Each row represents a cCRE and has both activity data - statistic and p-value and RNA/DNA counts. This is the key file for the activity chapter activity_per_rep: Read counts data for each cCRE by replicates and combined UMI_counts: Read counts data for each UMI oligo_fasta: Fasta file that includes all cCREs tested std_analysis_df: DNA and RNA counts after outlier filterings of several degrees of strictness screen_df: Overlap of cCRE library with screen data, each row represents a cCRE and must have a screen annotation of the following: Distal enhancer like sequence, DNase-only, Proximal enhancer like sequence, Heterochromatin, Promoter like sequence, DNase-H3K4me3. This file can be created using bedtools tss_df: Distance of each cCRE from the nearest TSS, each row must include a numeric value that represents the distance. This file can be created using bedtools AI_df: Comparison of MPRA activity data with an AI model predictions for the same cCREs AI_comparative_df: Same as above but for differential activity downsampling_activity_path: A path for a folder that includes comb_df for each sampling parameter downsampling_ratio_path: A path for a folder that includes activity_per_rep for each sampling parameter comparative_df: MPRA comparative results, each row represents a locus allelic_pairs_df: MPRA quantitative data, each row represents a locus and includes data for both alleles of the locus 1.2.3 Output Output figures are presented in this book in chapter 3 "],["associations-qc.html", "Chapter 2 Associations QC 2.1 cCREs per BC 2.2 UMIs per association 2.3 BCs per cCRE 2.4 Retained cCREs 2.5 cCRE retention by sequencing depth 2.6 BCs per cCRE by sequencing depth 2.7 PCR bias - GC 2.8 PCR bias - G Stretches", " Chapter 2 Associations QC 2.1 cCREs per BC Goal: Input file: Associations file before filtering for BC promiscuity Evaluated metrics: BC promiscuity Legend: Interpretation: 2.2 UMIs per association Goal: Input file: Associations file before filtering for minimal number of associations Evaluated metrics: Legend: Interpretation: 2.3 BCs per cCRE Goal: An empirical cumulative function (eCDF) of BCs per cCRE Input file: BC-cCRE association file Evaluated metrics: BC replicability Legend: Interpretation: 2.4 Retained cCREs Goal: Retained cCREs per increasing cutoffs of BC number per cCRE Input file: BC-cCRE association file Evaluated metrics: BC replicability Legend: Interpretation: 2.5 cCRE retention by sequencing depth Goal: This analysis uses downsampling of sequencing reads to assess whether sequencing depth is sufficient Input file: Downsampling association files Evaluated metrics: complexity Legend: Interpretation: 2.6 BCs per cCRE by sequencing depth Goal: Input file: Input file: Downsampling association files Evaluated metrics: Complexity** Legend: Interpretation: 2.7 PCR bias - GC Goal: This analysis assesses GC content bias in PCR amplification Input file: BC-cCRE association file Evaluated metrics: Complexity Legend: Interpretation: The successful example shows a relatively consistent number of reads per GC content, and PCR conditions that are optimized for the GC content levels of most cCREs (peaks are close to one another). The unsuccessful example shows both a strong amplification bias and suboptimal PCR conditions for the GC content levels of most cCREs 2.8 PCR bias - G Stretches Goal: This analysis assesses G-stretches bias in PCR amplification Input file: BC-cCRE association file Evaluated metrics: Complexity Legend: Interpretation: "],["activity-qc.html", "Chapter 3 Activity QC 3.1 Retained cCREs and barcodes 3.2 DNA counts vs GC content 3.3 Activity statistic vs count ratio 3.4 Differential activity statistic vs count ratio 3.5 Activity distribution 3.6 Differential activity distribution 3.7 P-value distribution 3.8 Volcano plot - FC vs Pval 3.9 BC retention by DNA/RNA sequencing depth 3.10 cCRE retention by DNA/RNA sequencing depth 3.11 Activity by sequencing depth 3.12 Cumulative RNA reads 3.13 Sample clustering 3.14 Correlation between replicates 3.15 Correlation of differential activity between replicates 3.16 Replicability by activity 3.17 Correlation between replicates (controls) 3.18 Cross-validation:allelic pairs 3.19 Cross-validaiton: cell types 3.20 Minimizing noise 3.21 Reproducibility by sequencing depth 3.22 RNA vs DNA 3.23 Activity of controls 3.24 Genomic annotations 3.25 Proximity to TSS 3.26 AI predictions vs activity 3.27 AI predictions vs differential activity", " Chapter 3 Activity QC 3.1 Retained cCREs and barcodes Goal: Assesses cCRE and BC coverage Input file: activity_per_rep Evaluated metrics: DNA Complexity, RNA Complexity: Legend: Percentage of cCREs and BCs present in the DNA and RNA quantification data compared with those observed in the association data Interpretation: 3.2 DNA counts vs GC content Goal: Input file: Evaluated metrics: Legend: Interpretation: 3.3 Activity statistic vs count ratio Goal: Input file: Evaluated metrics: Legend: Interpretation: 3.4 Differential activity statistic vs count ratio Goal: Input file: Evaluated metrics: Legend: Interpretation: 3.5 Activity distribution Goal: Assesses activity dynamic range, noise, and statistical power Input file: quantification table (comb_df) Evaluated metrics: DNA Complexity, RNA Complexity: Legend: Interpretation: 3.6 Differential activity distribution Goal: Assesses differential activity dynamic range, noise, and statistical power Input file: comparative_df Evaluated metrics: DNA Complexity, RNA Complexity Legend: Interpretation: 3.7 P-value distribution Goal: Inferring the power of the statistical test Input file: quantification table (comb_df) Evaluated metrics: DNA Complexity, RNA Complexity, Reproducibility, Dynamic range: Legend: Interpretation: 3.8 Volcano plot - FC vs Pval Goal: Input file: Evaluated metrics: Legend: Interpretation: 3.9 BC retention by DNA/RNA sequencing depth Goal: Input file: Evaluated metrics: Legend: Interpretation: 3.10 cCRE retention by DNA/RNA sequencing depth Goal: Input file: Evaluated metrics: Legend: Interpretation: 3.11 Activity by sequencing depth Goal: uses downsampling of sequencing reads to assess if sequencing depth is sufficient Input file: Downsampling activity data frames Evaluated metrics: DNA Complexity, RNA Complexity Legend: Interpretation: 3.12 Cumulative RNA reads Goal: assesses jackpotting Input file: quantification table (comb_df) Evaluated metrics: DNA Complexity, RNA Complexity: Legend: Interpretation: 3.13 Sample clustering Goal: Assesses reproducibility between samples Input file: cDNA_reads_by_cell_type Evaluated metrics: Reproducibility: mention in the bookdown: the importance of the percentage explained by the 1st and 2nd PCs. Legend: Principal component analysis (PCA) on samples Interpretation: 3.14 Correlation between replicates Goal: assesses reproducibility between replicates Input file: activity_per_rep Evaluated metrics: Reproducibility: Legend: Interpretation: 3.15 Correlation of differential activity between replicates Goal: Input file: Evaluated metrics: Legend: Interpretation: 3.16 Replicability by activity Goal: assesses the correlation in activity between replicates in active vs non-active cCREs Input file: Evaluated metrics: Reproducibility Legend: Interpretation: 3.17 Correlation between replicates (controls) Goal: analysis assesses reproducibility between replicates in positive and negative controls Input file: quantification table (comb_df) Evaluated metrics: Reproducibility Legend: Interpretation: 3.18 Cross-validation:allelic pairs Goal: Input file: Evaluated metrics: Legend: Interpretation: 3.19 Cross-validaiton: cell types Goal: Input file: Evaluated metrics: Legend: Interpretation: 3.20 Minimizing noise Goal: Removing outlier BCs and optimizing the threshold of minimum DNA counts to increase reproducibility Input file: Evaluated metrics: Reproducibility: Legend: Interpretation: 3.21 Reproducibility by sequencing depth Goal: Assesses whether additional sequencing will improve reproducibility between replicates Input file: Activity down sampling files Evaluated metrics: Reproducibility Legend: Interpretation: 3.22 RNA vs DNA Goal: Assesses if there is true activity in the experiment Input file: Evaluated metrics: Dynamic Range Legend: Interpretation: 3.23 Activity of controls Goal: assesses the dynamic range of activity Input file: quantification table (comb_df) Evaluated metrics: Dynamic Range: Legend: Interpretation: 3.24 Genomic annotations Goal: This analysis assesses concordance with endogenous signals of active chromatin marks Input file: Genomic annotation file Evaluated metrics: Dynamic Range Legend: Interpretation: 3.25 Proximity to TSS Goal: is analysis assesses concordance with endogenous locations of cCREs Input file: Distance to TSS file Evaluated metrics: Dynamic Range Legend: Interpretation: 3.26 AI predictions vs activity Goal: Input file: Evaluated metrics: Legend: Interpretation: 3.27 AI predictions vs differential activity Goal: Input file: Evaluated metrics: Legend: Interpretation: "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
